# ç”¨æˆ·ç™»å½•ç³»ç»Ÿè®¾è®¡æ–‡æ¡£

## ä¸€ã€ç³»ç»Ÿæ¦‚è¿°

### 1.1 åŠŸèƒ½ç›®æ ‡
ä¸ºç½‘çƒç¤¾äº¤å¹³å°æä¾›å®‰å…¨ã€ä¾¿æ·çš„ç”¨æˆ·èº«ä»½è®¤è¯ç³»ç»Ÿï¼Œé‡‡ç”¨ç°ä»£åŒ–çš„æ‰‹æœºå·éªŒè¯ç ç™»å½•æ–¹å¼ï¼Œæ”¯æŒä¸€é”®ç™»å½•ï¼Œæä¾›æµç•…çš„ç”¨æˆ·ä½“éªŒã€‚

### 1.2 æŠ€æœ¯æ ˆ
- **å‰ç«¯ï¼š** Flutter + Dart
- **çŠ¶æ€ç®¡ç†ï¼š** Riverpod
- **è·¯ç”±ç®¡ç†ï¼š** GoRouter
- **å“åº”å¼UIï¼š** flutter_screenutil
- **åç«¯ï¼š** FastAPI + Python
- **æ•°æ®åº“ï¼š** PostgreSQL
- **è®¤è¯æ–¹å¼ï¼š** JWT (JSON Web Token)
- **éªŒè¯ç æœåŠ¡ï¼š** é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡ / è…¾è®¯äº‘çŸ­ä¿¡
- **æœ¬åœ°å­˜å‚¨ï¼š** shared_preferences (å‰ç«¯)

---

## äºŒã€åŠŸèƒ½éœ€æ±‚

### 2.1 æ ¸å¿ƒåŠŸèƒ½åˆ—è¡¨

#### âœ… å¿…éœ€åŠŸèƒ½ï¼ˆMVPï¼‰
1. **æ‰‹æœºå·éªŒè¯ç ç™»å½•/æ³¨å†Œ**
   - æ‰‹æœºå·è¾“å…¥ï¼ˆæ”¯æŒå›½å®¶/åœ°åŒºä»£ç é€‰æ‹©ï¼‰
   - çŸ­ä¿¡éªŒè¯ç å‘é€
   - éªŒè¯ç éªŒè¯
   - è‡ªåŠ¨æ³¨å†Œæ–°ç”¨æˆ·
   - éªŒè¯ç å€’è®¡æ—¶ï¼ˆ60ç§’ï¼‰

2. **ä¸€é”®ç™»å½•**
   - ä¿å­˜å·²ç™»å½•çš„æ‰‹æœºå·
   - å¿«é€Ÿç™»å½•æŒ‰é’®
   - æœ¬åœ°å­˜å‚¨ç®¡ç†
   - åˆ‡æ¢è´¦å·åŠŸèƒ½

3. **Token ç®¡ç†**
   - JWT Token ç”Ÿæˆ
   - Token åˆ·æ–°æœºåˆ¶
   - Token è¿‡æœŸå¤„ç†
   - è‡ªåŠ¨ç™»å‡º

4. **ç”¨æˆ·ä¿¡æ¯è¡¥å…¨**
   - é¦–æ¬¡ç™»å½•åå¼•å¯¼å¡«å†™æ˜µç§°
   - ä¸Šä¼ å¤´åƒï¼ˆå¯é€‰ï¼‰
   - è®¾ç½®ç½‘çƒæ°´å¹³
   - ä¸ªäººç®€ä»‹

#### ğŸ”„ æ‰©å±•åŠŸèƒ½ï¼ˆV2ï¼‰
5. **ç¬¬ä¸‰æ–¹ç™»å½•**
   - å¾®ä¿¡ç™»å½•
   - QQ ç™»å½•
   - Apple ID ç™»å½•
   - æ‰‹æœºå·ç»‘å®š

6. **å®‰å…¨åŠŸèƒ½**
   - ç™»å½•è®¾å¤‡ç®¡ç†
   - å¼‚å¸¸ç™»å½•æé†’
   - ç™»å½•æ—¥å¿—
   - è´¦å·æ³¨é”€

---

## ä¸‰ã€æ•°æ®åº“è®¾è®¡

### 3.1 ç”¨æˆ·è¡¨ï¼ˆusersï¼‰

```sql
CREATE TABLE users (
    -- åŸºç¡€ä¿¡æ¯
    id SERIAL PRIMARY KEY,
    phone VARCHAR(20) UNIQUE NOT NULL,  -- ä¸»è¦ç™»å½•å‡­è¯
    country_code VARCHAR(10) DEFAULT '+86',  -- å›½å®¶ä»£ç 
    username VARCHAR(50) UNIQUE,  -- ç”¨æˆ·åï¼ˆå¯é€‰ï¼ŒåæœŸè¡¥å…¨ï¼‰
    
    -- ä¸ªäººèµ„æ–™
    avatar VARCHAR(500),
    nickname VARCHAR(100),
    bio TEXT,
    gender VARCHAR(10),  -- 'male', 'female', 'other', 'prefer_not_to_say'
    birth_date DATE,
    
    -- ç½‘çƒç›¸å…³
    skill_level VARCHAR(20) DEFAULT 'beginner',
    -- 'beginner' (åˆçº§), 'intermediate' (ä¸­çº§), 'advanced' (é«˜çº§), 'professional' (ä¸“ä¸š)
    play_style VARCHAR(50),  -- æ‰“æ³•é£æ ¼ï¼š'baseline', 'serve_and_volley', 'all_court'
    favorite_court VARCHAR(255),  -- å¸¸å»çƒåœº
    racket_brand VARCHAR(100),  -- çƒæ‹å“ç‰Œ
    
    -- è´¦æˆ·çŠ¶æ€
    is_active BOOLEAN DEFAULT TRUE,
    is_phone_verified BOOLEAN DEFAULT TRUE,  -- æ‰‹æœºå·éªŒè¯çŠ¶æ€ï¼ˆéªŒè¯ç ç™»å½•åè‡ªåŠ¨ä¸ºtrueï¼‰
    is_premium BOOLEAN DEFAULT FALSE,  -- ä¼šå‘˜çŠ¶æ€
    is_profile_completed BOOLEAN DEFAULT FALSE,  -- èµ„æ–™æ˜¯å¦å®Œå–„
    
    -- ç¬¬ä¸‰æ–¹ç™»å½•ï¼ˆæ‰©å±•ï¼‰
    wechat_openid VARCHAR(100) UNIQUE,
    qq_openid VARCHAR(100) UNIQUE,
    apple_id VARCHAR(100) UNIQUE,
    
    -- æ—¶é—´æˆ³
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    last_login_at TIMESTAMP WITH TIME ZONE,
    
    -- ç´¢å¼•
    CONSTRAINT users_phone_check CHECK (char_length(phone) >= 8),
    CONSTRAINT users_nickname_check CHECK (char_length(nickname) >= 2)
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_users_phone ON users(phone);
CREATE INDEX idx_users_country_code ON users(country_code);
CREATE INDEX idx_users_wechat_openid ON users(wechat_openid);
CREATE INDEX idx_users_created_at ON users(created_at DESC);
```

### 3.2 çŸ­ä¿¡éªŒè¯ç è¡¨ï¼ˆsms_verification_codesï¼‰

```sql
CREATE TABLE sms_verification_codes (
    id SERIAL PRIMARY KEY,
    phone VARCHAR(20) NOT NULL,
    country_code VARCHAR(10) DEFAULT '+86',
    code VARCHAR(6) NOT NULL,  -- 4-6ä½æ•°å­—éªŒè¯ç 
    
    -- éªŒè¯ç çŠ¶æ€
    is_used BOOLEAN DEFAULT FALSE,
    is_expired BOOLEAN DEFAULT FALSE,
    
    -- æ—¶é—´æ§åˆ¶
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP WITH TIME ZONE NOT NULL,  -- è¿‡æœŸæ—¶é—´ï¼ˆé€šå¸¸5-10åˆ†é’Ÿï¼‰
    used_at TIMESTAMP WITH TIME ZONE,
    
    -- å®‰å…¨æ§åˆ¶
    ip_address VARCHAR(45),  -- æ”¯æŒIPv6
    device_info TEXT,  -- è®¾å¤‡ä¿¡æ¯
    attempt_count INTEGER DEFAULT 0,  -- å°è¯•æ¬¡æ•°
    
    CONSTRAINT sms_codes_code_check CHECK (code ~ '^\d{4,6}$')
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_sms_phone_created ON sms_verification_codes(phone, created_at DESC);
CREATE INDEX idx_sms_expires ON sms_verification_codes(expires_at);

-- è‡ªåŠ¨æ¸…ç†è¿‡æœŸéªŒè¯ç ï¼ˆå¯é€‰ï¼Œé€šè¿‡å®šæ—¶ä»»åŠ¡ï¼‰
CREATE INDEX idx_sms_cleanup ON sms_verification_codes(created_at) 
WHERE is_expired = TRUE OR is_used = TRUE;
```

### 3.3 ç”¨æˆ·ä¼šè¯è¡¨ï¼ˆuser_sessionsï¼‰

```sql
CREATE TABLE user_sessions (
    id SERIAL PRIMARY KEY,
    user_id INTEGER NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    
    -- Tokenä¿¡æ¯
    access_token VARCHAR(500) UNIQUE NOT NULL,
    refresh_token VARCHAR(500) UNIQUE NOT NULL,
    token_type VARCHAR(20) DEFAULT 'Bearer',
    
    -- è®¾å¤‡ä¿¡æ¯
    device_name VARCHAR(100),  -- è®¾å¤‡åç§°ï¼šiPhone 13, Xiaomi 11 ç­‰
    device_type VARCHAR(50),  -- è®¾å¤‡ç±»å‹ï¼šiOS, Android, Web
    device_id VARCHAR(255),  -- è®¾å¤‡å”¯ä¸€æ ‡è¯†
    
    -- ç™»å½•ä¿¡æ¯
    ip_address VARCHAR(45),
    user_agent TEXT,
    location VARCHAR(255),  -- ç™»å½•åœ°ç‚¹ï¼ˆå¯é€‰ï¼‰
    
    -- çŠ¶æ€æ§åˆ¶
    is_active BOOLEAN DEFAULT TRUE,
    
    -- æ—¶é—´æˆ³
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    last_active_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    expires_at TIMESTAMP WITH TIME ZONE NOT NULL
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_sessions_user ON user_sessions(user_id);
CREATE INDEX idx_sessions_access_token ON user_sessions(access_token);
CREATE INDEX idx_sessions_refresh_token ON user_sessions(refresh_token);
CREATE INDEX idx_sessions_active ON user_sessions(user_id, is_active);
```

### 3.4 ç™»å½•æ—¥å¿—è¡¨ï¼ˆlogin_logsï¼‰

```sql
CREATE TABLE login_logs (
    id SERIAL PRIMARY KEY,
    user_id INTEGER REFERENCES users(id) ON DELETE SET NULL,
    phone VARCHAR(20) NOT NULL,
    
    -- ç™»å½•æ–¹å¼
    login_method VARCHAR(50) NOT NULL,  -- 'sms_code', 'one_click', 'wechat', 'qq', 'apple'
    login_status VARCHAR(20) NOT NULL,  -- 'success', 'failed', 'blocked'
    
    -- å¤±è´¥åŸå› 
    failure_reason VARCHAR(255),  -- 'invalid_code', 'expired_code', 'account_blocked' ç­‰
    
    -- è®¾å¤‡å’Œä½ç½®ä¿¡æ¯
    ip_address VARCHAR(45),
    device_type VARCHAR(50),
    device_name VARCHAR(100),
    user_agent TEXT,
    location VARCHAR(255),
    
    -- æ—¶é—´æˆ³
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- åˆ›å»ºç´¢å¼•
CREATE INDEX idx_login_logs_user ON login_logs(user_id, created_at DESC);
CREATE INDEX idx_login_logs_phone ON login_logs(phone, created_at DESC);
CREATE INDEX idx_login_logs_status ON login_logs(login_status, created_at DESC);
```

---

## å››ã€ç™»å½•æµç¨‹è®¾è®¡

### 4.1 é¦–æ¬¡ç™»å½•æµç¨‹

```mermaid
flowchart TD
    Start([ç”¨æˆ·æ‰“å¼€APP]) --> CheckToken{æ£€æŸ¥æœ¬åœ°Token}
    CheckToken -->|æ— Token| ShowLogin[æ˜¾ç¤ºç™»å½•é¡µé¢]
    CheckToken -->|æœ‰Token| ValidateToken{éªŒè¯Tokenæœ‰æ•ˆæ€§}
    
    ValidateToken -->|æœ‰æ•ˆ| LoadUserInfo[åŠ è½½ç”¨æˆ·ä¿¡æ¯]
    ValidateToken -->|æ— æ•ˆ/è¿‡æœŸ| RefreshToken{å°è¯•åˆ·æ–°Token}
    
    RefreshToken -->|æˆåŠŸ| LoadUserInfo
    RefreshToken -->|å¤±è´¥| ShowLogin
    
    ShowLogin --> CheckSavedPhone{æ£€æŸ¥æœ¬åœ°ä¿å­˜çš„æ‰‹æœºå·}
    CheckSavedPhone -->|æœ‰| ShowOneClick[æ˜¾ç¤ºä¸€é”®ç™»å½•ç•Œé¢]
    CheckSavedPhone -->|æ— | ShowPhoneInput[æ˜¾ç¤ºæ‰‹æœºå·è¾“å…¥ç•Œé¢]
    
    ShowPhoneInput --> SelectCountry[é€‰æ‹©å›½å®¶ä»£ç ]
    SelectCountry --> InputPhone[è¾“å…¥æ‰‹æœºå·]
    InputPhone --> ValidatePhone{éªŒè¯æ‰‹æœºå·æ ¼å¼}
    
    ValidatePhone -->|æ— æ•ˆ| ShowPhoneError[æ˜¾ç¤ºæ ¼å¼é”™è¯¯]
    ShowPhoneError --> InputPhone
    
    ValidatePhone -->|æœ‰æ•ˆ| AgreeTerms{åŒæ„ç”¨æˆ·åè®®?}
    AgreeTerms -->|æœªåŒæ„| ShowTermsError[æç¤ºéœ€è¦åŒæ„åè®®]
    ShowTermsError --> AgreeTerms
    
    AgreeTerms -->|å·²åŒæ„| ClickNext[ç‚¹å‡»ä¸‹ä¸€æ­¥]
    ClickNext --> SendSMS[å‘é€çŸ­ä¿¡éªŒè¯ç ]
    
    SendSMS --> CheckSMSLimit{æ£€æŸ¥å‘é€é¢‘ç‡}
    CheckSMSLimit -->|è¶…å‡ºé™åˆ¶| ShowRateLimit[æ˜¾ç¤º: è¯·ç¨åå†è¯•]
    ShowRateLimit --> ShowPhoneInput
    
    CheckSMSLimit -->|æœªè¶…å‡º| GenerateCode[ç”Ÿæˆ6ä½æ•°å­—éªŒè¯ç ]
    GenerateCode --> SaveCodeDB[ä¿å­˜éªŒè¯ç åˆ°æ•°æ®åº“]
    SaveCodeDB --> CallSMSAPI[è°ƒç”¨çŸ­ä¿¡APIå‘é€]
    
    CallSMSAPI -->|å¤±è´¥| ShowSMSError[æ˜¾ç¤ºå‘é€å¤±è´¥]
    ShowSMSError --> ClickResend{ç‚¹å‡»é‡æ–°å‘é€?}
    ClickResend -->|æ˜¯| SendSMS
    ClickResend -->|å¦| ShowPhoneInput
    
    CallSMSAPI -->|æˆåŠŸ| ShowCodeInput[è·³è½¬åˆ°éªŒè¯ç è¾“å…¥é¡µé¢]
    ShowCodeInput --> StartCountdown[å¼€å§‹60ç§’å€’è®¡æ—¶]
    StartCountdown --> InputCode[è¾“å…¥éªŒè¯ç ]
    
    InputCode --> AutoSubmit{è¾“å…¥å®Œ4ä½æ•°å­—?}
    AutoSubmit -->|æ˜¯| VerifyCode[éªŒè¯éªŒè¯ç ]
    
    VerifyCode --> CheckCodeValid{éªŒè¯ç æ­£ç¡®?}
    CheckCodeValid -->|é”™è¯¯| ShowCodeError[æ˜¾ç¤ºéªŒè¯ç é”™è¯¯]
    ShowCodeError --> CodeRetry{é‡è¯•æ¬¡æ•°<3?}
    CodeRetry -->|æ˜¯| InputCode
    CodeRetry -->|å¦| BlockAttempt[é”å®š10åˆ†é’Ÿ]
    BlockAttempt --> ShowPhoneInput
    
    CheckCodeValid -->|æ­£ç¡®| MarkCodeUsed[æ ‡è®°éªŒè¯ç å·²ä½¿ç”¨]
    MarkCodeUsed --> CheckUserExists{ç”¨æˆ·æ˜¯å¦å­˜åœ¨?}
    
    CheckUserExists -->|ä¸å­˜åœ¨| CreateNewUser[åˆ›å»ºæ–°ç”¨æˆ·]
    CreateNewUser --> SetPhoneVerified[è®¾ç½®æ‰‹æœºå·å·²éªŒè¯]
    SetPhoneVerified --> GenerateTokens
    
    CheckUserExists -->|å­˜åœ¨| UpdateLoginTime[æ›´æ–°æœ€åç™»å½•æ—¶é—´]
    UpdateLoginTime --> GenerateTokens[ç”ŸæˆJWT Tokens]
    
    GenerateTokens --> SaveLocal[ä¿å­˜Tokenåˆ°æœ¬åœ°]
    SaveLocal --> SavePhoneLocal[ä¿å­˜æ‰‹æœºå·åˆ°æœ¬åœ°]
    SavePhoneLocal --> CreateSession[åˆ›å»ºä¼šè¯è®°å½•]
    CreateSession --> LogSuccess[è®°å½•ç™»å½•æˆåŠŸæ—¥å¿—]
    
    LogSuccess --> CheckProfile{æ£€æŸ¥èµ„æ–™å®Œæ•´åº¦}
    CheckProfile -->|æœªå®Œå–„| GuideProfile[å¼•å¯¼å®Œå–„èµ„æ–™]
    CheckProfile -->|å·²å®Œå–„| EnterApp[è¿›å…¥åº”ç”¨ä¸»é¡µ]
    
    GuideProfile --> FillNickname[å¡«å†™æ˜µç§°]
    FillNickname --> SelectSkillLevel[é€‰æ‹©ç½‘çƒæ°´å¹³]
    SelectSkillLevel --> UploadAvatar[ä¸Šä¼ å¤´åƒå¯é€‰]
    UploadAvatar --> CompleteProfile[æ ‡è®°èµ„æ–™å·²å®Œå–„]
    CompleteProfile --> EnterApp
    
    LoadUserInfo --> EnterApp
    EnterApp --> End([ç™»å½•å®Œæˆ])
    
    style Start fill:#e1f5e1
    style End fill:#ffe1e1
    style GenerateTokens fill:#fff4e1
    style CreateNewUser fill:#e1f0ff
    style EnterApp fill:#f0e1ff
```

### 4.2 è€ç”¨æˆ·ä¸€é”®ç™»å½•æµç¨‹

```mermaid
flowchart TD
    Start([ç”¨æˆ·æ‰“å¼€APP]) --> CheckSavedPhone{æ£€æŸ¥æœ¬åœ°æ‰‹æœºå·}
    CheckSavedPhone -->|æ— | NormalLogin[è½¬åˆ°é¦–æ¬¡ç™»å½•æµç¨‹]
    CheckSavedPhone -->|æœ‰| ShowMaskedPhone[æ˜¾ç¤ºè„±æ•æ‰‹æœºå·]
    
    ShowMaskedPhone --> DisplayUI[æ˜¾ç¤ºä¸€é”®ç™»å½•ç•Œé¢]
    DisplayUI --> UserChoice{ç”¨æˆ·é€‰æ‹©}
    
    UserChoice -->|ç‚¹å‡»ä¸€é”®ç™»å½•| CheckLocalToken{æ£€æŸ¥æœ¬åœ°Token}
    UserChoice -->|ç‚¹å‡»æ¢å·ç™»å½•| ClearLocalData[æ¸…é™¤æœ¬åœ°æ•°æ®]
    
    ClearLocalData --> NormalLogin
    
    CheckLocalToken -->|æ— Token| StartCodeLogin[å¼€å§‹éªŒè¯ç ç™»å½•]
    CheckLocalToken -->|æœ‰Token| ValidateToken{Tokenæ˜¯å¦æœ‰æ•ˆ?}
    
    ValidateToken -->|æœ‰æ•ˆ| DirectLogin[ç›´æ¥ç™»å½•æˆåŠŸ]
    ValidateToken -->|è¿‡æœŸ| RefreshToken{å°è¯•åˆ·æ–°Token}
    
    RefreshToken -->|æˆåŠŸ| UpdateLocalToken[æ›´æ–°æœ¬åœ°Token]
    UpdateLocalToken --> DirectLogin
    
    RefreshToken -->|å¤±è´¥| StartCodeLogin
    
    StartCodeLogin --> ShowLoading[æ˜¾ç¤ºåŠ è½½åŠ¨ç”»]
    ShowLoading --> SendSMSAuto[è‡ªåŠ¨å‘é€éªŒè¯ç ]
    SendSMSAuto --> ShowCodeInput[è·³è½¬éªŒè¯ç é¡µé¢]
    ShowCodeInput --> InputCode[è¾“å…¥éªŒè¯ç ]
    
    InputCode --> VerifyCode[éªŒè¯éªŒè¯ç ]
    VerifyCode -->|æˆåŠŸ| GenerateNewTokens[ç”Ÿæˆæ–°Token]
    VerifyCode -->|å¤±è´¥| ShowError[æ˜¾ç¤ºé”™è¯¯æç¤º]
    ShowError --> InputCode
    
    GenerateNewTokens --> SaveTokensLocal[ä¿å­˜Tokenåˆ°æœ¬åœ°]
    SaveTokensLocal --> UpdateSession[æ›´æ–°ä¼šè¯ä¿¡æ¯]
    UpdateSession --> LogLoginSuccess[è®°å½•ç™»å½•æ—¥å¿—]
    
    DirectLogin --> LoadUserData[åŠ è½½ç”¨æˆ·æ•°æ®]
    LogLoginSuccess --> LoadUserData
    
    LoadUserData --> EnterApp[è¿›å…¥åº”ç”¨ä¸»é¡µ]
    EnterApp --> End([ç™»å½•å®Œæˆ])
    
    style Start fill:#e1f5e1
    style End fill:#ffe1e1
    style DirectLogin fill:#e1f0ff
    style GenerateNewTokens fill:#fff4e1
```

### 4.3 å›½å®¶ä»£ç é€‰æ‹©æµç¨‹

```mermaid
flowchart TD
    Start([ç‚¹å‡»å›½å®¶ä»£ç ]) --> OpenPicker[æ‰“å¼€å›½å®¶ä»£ç é€‰æ‹©é¡µé¢]
    OpenPicker --> ShowList[æ˜¾ç¤ºå›½å®¶åˆ—è¡¨]
    
    ShowList --> HighlightCurrent[é«˜äº®å½“å‰é€‰ä¸­çš„å›½å®¶]
    HighlightCurrent --> UserAction{ç”¨æˆ·æ“ä½œ}
    
    UserAction -->|æ»šåŠ¨æµè§ˆ| ViewList[æŸ¥çœ‹æ›´å¤šå›½å®¶]
    ViewList --> UserAction
    
    UserAction -->|è¾“å…¥æœç´¢| SearchCountry[æœç´¢å›½å®¶]
    SearchCountry --> FilterList[è¿‡æ»¤åˆ—è¡¨]
    FilterList --> ShowResults[æ˜¾ç¤ºæœç´¢ç»“æœ]
    ShowResults --> UserAction
    
    UserAction -->|ç‚¹å‡»å›½å®¶| SelectCountry[é€‰æ‹©å›½å®¶ä»£ç ]
    SelectCountry --> UpdateCode[æ›´æ–°å›½å®¶ä»£ç ]
    UpdateCode --> ClosePickerReturn[å…³é—­é¡µé¢è¿”å›]
    
    UserAction -->|ç‚¹å‡»è¿”å›| ClosePickerCancel[å–æ¶ˆå¹¶è¿”å›]
    
    ClosePickerReturn --> UpdateUI[æ›´æ–°ç™»å½•é¡µé¢æ˜¾ç¤º]
    ClosePickerCancel --> KeepOriginal[ä¿æŒåŸæœ‰ä»£ç ]
    
    UpdateUI --> End([é€‰æ‹©å®Œæˆ])
    KeepOriginal --> End
    
    style Start fill:#e1f5e1
    style End fill:#ffe1e1
    style SelectCountry fill:#fff4e1
```

---

## äº”ã€APIæ¥å£è®¾è®¡

### 5.1 å‘é€çŸ­ä¿¡éªŒè¯ç 

**æ¥å£åœ°å€ï¼š** `POST /api/v1/auth/send-sms-code`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "phone": "15257854295",
  "country_code": "+86",
  "device_info": {
    "device_id": "uuid-xxx",
    "device_type": "iOS",
    "device_name": "iPhone 13"
  }
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "éªŒè¯ç å·²å‘é€",
  "data": {
    "expires_in": 300,  // 5åˆ†é’Ÿè¿‡æœŸ
    "resend_after": 60,  // 60ç§’åå¯é‡æ–°å‘é€
    "code_length": 4
  }
}
```

**é”™è¯¯å“åº”ï¼š**
```json
{
  "success": false,
  "error": {
    "code": "RATE_LIMIT_EXCEEDED",
    "message": "å‘é€è¿‡äºé¢‘ç¹ï¼Œè¯·60ç§’åå†è¯•"
  }
}
```

### 5.2 éªŒè¯ç ç™»å½•

**æ¥å£åœ°å€ï¼š** `POST /api/v1/auth/login-with-sms`

**è¯·æ±‚å‚æ•°ï¼š**
```json
{
  "phone": "15257854295",
  "country_code": "+86",
  "code": "1234",
  "device_info": {
    "device_id": "uuid-xxx",
    "device_type": "iOS",
    "device_name": "iPhone 13",
    "device_model": "iPhone14,5",
    "os_version": "17.0"
  }
}
```

**å“åº”ç¤ºä¾‹ï¼ˆæˆåŠŸï¼‰ï¼š**
```json
{
  "success": true,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "user": {
      "id": 12345,
      "phone": "15257854295",
      "country_code": "+86",
      "nickname": "ç½‘çƒçˆ±å¥½è€…",
      "avatar": "https://cdn.example.com/avatars/12345.jpg",
      "skill_level": "intermediate",
      "is_profile_completed": true,
      "is_new_user": false
    },
    "tokens": {
      "access_token": "eyJhbGc...",
      "refresh_token": "eyJhbGc...",
      "token_type": "Bearer",
      "expires_in": 1800  // 30åˆ†é’Ÿ
    }
  }
}
```

**å“åº”ç¤ºä¾‹ï¼ˆé¦–æ¬¡æ³¨å†Œï¼‰ï¼š**
```json
{
  "success": true,
  "message": "æ³¨å†Œå¹¶ç™»å½•æˆåŠŸ",
  "data": {
    "user": {
      "id": 12346,
      "phone": "15257854295",
      "country_code": "+86",
      "nickname": null,
      "avatar": null,
      "skill_level": "beginner",
      "is_profile_completed": false,
      "is_new_user": true
    },
    "tokens": {
      "access_token": "eyJhbGc...",
      "refresh_token": "eyJhbGc...",
      "token_type": "Bearer",
      "expires_in": 1800
    }
  }
}
```

**é”™è¯¯å“åº”ï¼š**
```json
{
  "success": false,
  "error": {
    "code": "INVALID_CODE",
    "message": "éªŒè¯ç é”™è¯¯æˆ–å·²è¿‡æœŸ",
    "attempts_remaining": 2
  }
}
```

### 5.3 åˆ·æ–°Token

**æ¥å£åœ°å€ï¼š** `POST /api/v1/auth/refresh-token`

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer {refresh_token}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "data": {
    "access_token": "eyJhbGc...",
    "token_type": "Bearer",
    "expires_in": 1800
  }
}
```

### 5.4 ç™»å‡º

**æ¥å£åœ°å€ï¼š** `POST /api/v1/auth/logout`

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer {access_token}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "message": "ç™»å‡ºæˆåŠŸ"
}
```

### 5.5 è·å–ç”¨æˆ·ä¿¡æ¯

**æ¥å£åœ°å€ï¼š** `GET /api/v1/users/me`

**è¯·æ±‚å¤´ï¼š**
```
Authorization: Bearer {access_token}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "success": true,
  "data": {
    "id": 12345,
    "phone": "15257854295",
    "country_code": "+86",
    "username": "tennis_lover",
    "nickname": "ç½‘çƒçˆ±å¥½è€…",
    "avatar": "https://cdn.example.com/avatars/12345.jpg",
    "bio": "çƒ­çˆ±ç½‘çƒï¼Œå¯»æ‰¾çƒå‹ä¸€èµ·è¿›æ­¥ï¼",
    "gender": "male",
    "birth_date": "1995-06-15",
    "skill_level": "intermediate",
    "play_style": "baseline",
    "favorite_court": "å¥¥æ—åŒ¹å…‹æ£®æ—å…¬å›­ç½‘çƒåœº",
    "is_profile_completed": true,
    "is_premium": false,
    "created_at": "2024-01-15T08:30:00Z",
    "last_login_at": "2024-11-06T10:25:00Z"
  }
}
```

---

## å…­ã€å‰ç«¯å®ç°è¦ç‚¹

### 6.1 é¡µé¢ç»„ä»¶

#### 1. ç™»å½•ä¸»é¡µé¢ (`login_screen.dart`)
**åŠŸèƒ½ï¼š**
- æ£€æµ‹æ˜¯å¦æœ‰ä¿å­˜çš„æ‰‹æœºå·
- æ–°ç”¨æˆ·ï¼šæ˜¾ç¤ºæ‰‹æœºå·è¾“å…¥ç•Œé¢
- è€ç”¨æˆ·ï¼šæ˜¾ç¤ºä¸€é”®ç™»å½•ç•Œé¢

**æ ¸å¿ƒçŠ¶æ€ï¼š**
```dart
- _isReturningUser: bool  // æ˜¯å¦æ˜¯è€ç”¨æˆ·
- _savedMaskedPhone: String?  // è„±æ•çš„æ‰‹æœºå·
- _phoneController: TextEditingController  // æ‰‹æœºå·è¾“å…¥
- _countryCode: String  // å›½å®¶ä»£ç 
- _agreeToTerms: bool  // æ˜¯å¦åŒæ„åè®®
```

**å…³é”®æ–¹æ³•ï¼š**
```dart
- _checkSavedPhoneNumber()  // æ£€æŸ¥æœ¬åœ°ä¿å­˜çš„æ‰‹æœºå·
- _handleSmsLogin()  // å¤„ç†éªŒè¯ç ç™»å½•
- _handleOneClickLogin()  // å¤„ç†ä¸€é”®ç™»å½•
- _handleOtherPhoneLogin()  // åˆ‡æ¢è´¦å·
```

#### 2. éªŒè¯ç è¾“å…¥é¡µé¢ (`sms_login_screen.dart`)
**åŠŸèƒ½ï¼š**
- æ˜¾ç¤ºæ ¼å¼åŒ–çš„æ‰‹æœºå·
- 4ä¸ªç‹¬ç«‹çš„éªŒè¯ç è¾“å…¥æ¡†
- 60ç§’å€’è®¡æ—¶
- è‡ªåŠ¨æäº¤éªŒè¯

**æ ¸å¿ƒçŠ¶æ€ï¼š**
```dart
- _codeControllers: List<TextEditingController>  // 4ä¸ªè¾“å…¥æ¡†
- _codeFocusNodes: List<FocusNode>  // ç„¦ç‚¹ç®¡ç†
- _countdown: int  // å€’è®¡æ—¶ç§’æ•°
- _isLoading: bool  // åŠ è½½çŠ¶æ€
```

**å…³é”®æ–¹æ³•ï¼š**
```dart
- _startCountdown()  // å¼€å§‹å€’è®¡æ—¶
- _onCodeComplete()  // éªŒè¯ç è¾“å…¥å®Œæˆ
- _handleResend()  // é‡æ–°å‘é€éªŒè¯ç 
```

#### 3. å›½å®¶ä»£ç é€‰æ‹©é¡µé¢ (`country_code_picker_screen.dart`)
**åŠŸèƒ½ï¼š**
- æ˜¾ç¤ºå›½å®¶åˆ—è¡¨
- æœç´¢åŠŸèƒ½
- é«˜äº®å½“å‰é€‰ä¸­

**æ•°æ®ç»“æ„ï¼š**
```dart
class Country {
  final String name;
  final String code;
  final String dialCode;
}
```

### 6.2 æœ¬åœ°å­˜å‚¨æœåŠ¡ (`storage_service.dart`)

**æ ¸å¿ƒæ–¹æ³•ï¼š**
```dart
class StorageService {
  // ä¿å­˜æ‰‹æœºå·
  static Future<void> savePhoneNumber(String phoneNumber)
  
  // è·å–æ‰‹æœºå·
  static Future<String?> getPhoneNumber()
  
  // è·å–è„±æ•æ‰‹æœºå·ï¼ˆ152****4295ï¼‰
  static Future<String?> getMaskedPhoneNumber()
  
  // æ£€æŸ¥æ˜¯å¦æœ‰ä¿å­˜çš„æ‰‹æœºå·
  static Future<bool> hasPhoneNumber()
  
  // æ¸…é™¤ä¿å­˜çš„æ‰‹æœºå·
  static Future<void> clearPhoneNumber()
  
  // ä¿å­˜Token
  static Future<void> saveTokens(String accessToken, String refreshToken)
  
  // è·å–Access Token
  static Future<String?> getAccessToken()
  
  // è·å–Refresh Token
  static Future<String?> getRefreshToken()
  
  // æ¸…é™¤Token
  static Future<void> clearTokens()
}
```

### 6.3 è®¤è¯æœåŠ¡ (`auth_service.dart`)

**æ ¸å¿ƒæ–¹æ³•ï¼š**
```dart
class AuthService {
  final ApiService _apiService;
  
  // å‘é€çŸ­ä¿¡éªŒè¯ç 
  Future<ApiResponse> sendSmsCode({
    required String phone,
    required String countryCode,
  })
  
  // éªŒè¯ç ç™»å½•
  Future<LoginResponse> loginWithSms({
    required String phone,
    required String countryCode,
    required String code,
  })
  
  // åˆ·æ–°Token
  Future<TokenResponse> refreshToken(String refreshToken)
  
  // ç™»å‡º
  Future<void> logout()
  
  // è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
  Future<User> getCurrentUser()
}
```

### 6.4 çŠ¶æ€ç®¡ç† (`auth_provider.dart`)

**ä½¿ç”¨Riverpodç®¡ç†è®¤è¯çŠ¶æ€ï¼š**
```dart
// è®¤è¯çŠ¶æ€Provider
final authStateProvider = StateNotifierProvider<AuthNotifier, AuthState>((ref) {
  return AuthNotifier(ref.read(authServiceProvider));
});

// è®¤è¯çŠ¶æ€
class AuthState {
  final User? user;
  final bool isAuthenticated;
  final bool isLoading;
  final String? error;
}

// è®¤è¯æ“ä½œ
class AuthNotifier extends StateNotifier<AuthState> {
  Future<void> sendSmsCode(String phone, String countryCode)
  Future<void> loginWithSms(String phone, String countryCode, String code)
  Future<void> oneClickLogin()
  Future<void> logout()
  Future<void> checkAuthStatus()
}
```

### 6.5 è·¯ç”±é…ç½® (`app_router.dart`)

```dart
final appRouter = GoRouter(
  initialLocation: '/splash',
  redirect: (context, state) {
    final isAuthenticated = // æ£€æŸ¥è®¤è¯çŠ¶æ€
    final isGoingToAuth = state.location.startsWith('/login');
    
    // æœªè®¤è¯ä¸”ä¸åœ¨ç™»å½•é¡µ -> è·³è½¬åˆ°ç™»å½•
    if (!isAuthenticated && !isGoingToAuth) {
      return '/login';
    }
    
    // å·²è®¤è¯ä¸”åœ¨ç™»å½•é¡µ -> è·³è½¬åˆ°é¦–é¡µ
    if (isAuthenticated && isGoingToAuth) {
      return '/home';
    }
    
    return null;
  },
  routes: [
    GoRoute(
      path: '/splash',
      builder: (context, state) => const SplashScreen(),
    ),
    GoRoute(
      path: '/login',
      builder: (context, state) => const LoginScreen(),
    ),
    GoRoute(
      path: '/login-sms',
      builder: (context, state) {
        final phone = state.extra as String?;
        return SmsLoginScreen(initialPhone: phone ?? '');
      },
    ),
    GoRoute(
      path: '/country-code-picker',
      builder: (context, state) => const CountryCodePickerScreen(),
    ),
    GoRoute(
      path: '/home',
      builder: (context, state) => const HomeScreen(),
    ),
  ],
);
```

---

## ä¸ƒã€å®‰å…¨æœºåˆ¶

### 7.1 éªŒè¯ç å®‰å…¨

1. **é¢‘ç‡é™åˆ¶**
   - åŒä¸€æ‰‹æœºå·ï¼š60ç§’å†…åªèƒ½å‘é€1æ¬¡
   - åŒä¸€IPï¼š1å°æ—¶å†…æœ€å¤šå‘é€10æ¬¡
   - åŒä¸€è®¾å¤‡ï¼š1å°æ—¶å†…æœ€å¤šå‘é€20æ¬¡

2. **éªŒè¯ç è§„åˆ™**
   - é•¿åº¦ï¼š4ä½æ•°å­—
   - æœ‰æ•ˆæœŸï¼š5åˆ†é’Ÿ
   - ä¸€æ¬¡æ€§ä½¿ç”¨ï¼šéªŒè¯åç«‹å³å¤±æ•ˆ
   - å°è¯•æ¬¡æ•°é™åˆ¶ï¼šæœ€å¤š3æ¬¡ï¼Œè¶…è¿‡åé”å®š10åˆ†é’Ÿ

3. **é˜²åˆ·æœºåˆ¶**
   - è®°å½•IPåœ°å€å’Œè®¾å¤‡ä¿¡æ¯
   - å¼‚å¸¸è¡Œä¸ºæ£€æµ‹ï¼ˆçŸ­æ—¶é—´å¤§é‡è¯·æ±‚ï¼‰
   - éªŒè¯ç ç­”æ¡ˆä¸åœ¨å“åº”ä¸­è¿”å›

### 7.2 Tokenå®‰å…¨

1. **Tokenè®¾è®¡**
   - Access Tokenï¼š30åˆ†é’Ÿæœ‰æ•ˆæœŸ
   - Refresh Tokenï¼š7å¤©æœ‰æ•ˆæœŸ
   - é‡‡ç”¨JWTæ ‡å‡†
   - åŒ…å«ç”¨æˆ·IDã€è®¾å¤‡IDç­‰ä¿¡æ¯

2. **Tokenåˆ·æ–°ç­–ç•¥**
   - Access Tokenè¿‡æœŸå‰5åˆ†é’Ÿè‡ªåŠ¨åˆ·æ–°
   - Refresh Tokenè¿‡æœŸéœ€é‡æ–°ç™»å½•
   - è®¾å¤‡IDç»‘å®šï¼Œé˜²æ­¢Tokenè¢«ç›—ç”¨

3. **Tokenå­˜å‚¨**
   - ä½¿ç”¨SharedPreferenceså®‰å…¨å­˜å‚¨
   - è€ƒè™‘ä½¿ç”¨flutter_secure_storageåŠ å¯†å­˜å‚¨
   - é€€å‡ºç™»å½•æ—¶æ¸…é™¤æ‰€æœ‰Token

### 7.3 ä¼šè¯ç®¡ç†

1. **å¤šè®¾å¤‡ç®¡ç†**
   - è®°å½•æ‰€æœ‰ç™»å½•è®¾å¤‡
   - æ”¯æŒæŸ¥çœ‹å’Œè¸¢å‡ºå…¶ä»–è®¾å¤‡
   - æœ€å¤šä¿æŒ5ä¸ªæ´»è·ƒä¼šè¯

2. **å¼‚å¸¸ç™»å½•æ£€æµ‹**
   - æ–°è®¾å¤‡ç™»å½•æé†’
   - å¼‚åœ°ç™»å½•æé†’
   - å¯ç–‘æ“ä½œæé†’

---

## å…«ã€ç”¨æˆ·ä½“éªŒä¼˜åŒ–

### 8.1 UI/UXè®¾è®¡åŸåˆ™

1. **Keep Appé£æ ¼**
   - ç´«è‰²æ¸å˜èƒŒæ™¯
   - åŠé€æ˜è¾“å…¥æ¡†
   - åœ†è§’è®¾è®¡
   - ç™½è‰²æ–‡å­—å’ŒæŒ‰é’®

2. **äº¤äº’æµç•…æ€§**
   - è‡ªåŠ¨è·³è½¬è¾“å…¥æ¡†
   - è¾“å…¥å®Œæˆè‡ªåŠ¨æäº¤
   - åŠ è½½çŠ¶æ€æ˜ç¡®
   - é”™è¯¯æç¤ºæ¸…æ™°

3. **ä¸€é”®ç™»å½•ä¼˜åŒ–**
   - è„±æ•æ˜¾ç¤ºæ‰‹æœºå·
   - æ˜æ˜¾çš„ä¸€é”®ç™»å½•æŒ‰é’®
   - å¿«é€Ÿåˆ‡æ¢è´¦å·é€‰é¡¹

### 8.2 é”™è¯¯å¤„ç†

1. **ç½‘ç»œé”™è¯¯**
   - æ˜¾ç¤ºå‹å¥½çš„é”™è¯¯æç¤º
   - æä¾›é‡è¯•æŒ‰é’®
   - è¶…æ—¶å¤„ç†

2. **éªŒè¯ç é”™è¯¯**
   - æ¸…æ™°çš„é”™è¯¯ä¿¡æ¯
   - å‰©ä½™å°è¯•æ¬¡æ•°æç¤º
   - é‡æ–°å‘é€éªŒè¯ç é€‰é¡¹

3. **ç³»ç»Ÿé”™è¯¯**
   - å…œåº•é”™è¯¯é¡µé¢
   - è”ç³»å®¢æœå…¥å£
   - é”™è¯¯æ—¥å¿—ä¸ŠæŠ¥

### 8.3 æ— éšœç¢æ”¯æŒ

1. **å±å¹•é˜…è¯»å™¨æ”¯æŒ**
   - Semanticsæ ‡ç­¾
   - è¯­ä¹‰åŒ–æè¿°

2. **å­—ä½“å¤§å°é€‚é…**
   - å“åº”ç³»ç»Ÿå­—ä½“è®¾ç½®
   - ä½¿ç”¨spå•ä½

---

## ä¹ã€æµ‹è¯•æ–¹æ¡ˆ

### 9.1 å•å…ƒæµ‹è¯•

```dart
// éªŒè¯æ‰‹æœºå·æ ¼å¼
test('validate phone number format', () {
  expect(Validators.isValidPhone('15257854295'), true);
  expect(Validators.isValidPhone('1234'), false);
});

// éªŒè¯ç æ ¼å¼
test('validate sms code format', () {
  expect(Validators.isValidSmsCode('1234'), true);
  expect(Validators.isValidSmsCode('12'), false);
});

// Tokenå­˜å‚¨å’Œè·å–
test('save and get token', () async {
  await StorageService.saveTokens('access_token', 'refresh_token');
  final accessToken = await StorageService.getAccessToken();
  expect(accessToken, 'access_token');
});
```

### 9.2 é›†æˆæµ‹è¯•

```dart
// å®Œæ•´ç™»å½•æµç¨‹æµ‹è¯•
testWidgets('complete login flow', (tester) async {
  await tester.pumpWidget(MyApp());
  
  // è¾“å…¥æ‰‹æœºå·
  await tester.enterText(
    find.byType(TextField),
    '15257854295'
  );
  
  // åŒæ„åè®®
  await tester.tap(find.byType(Checkbox));
  
  // ç‚¹å‡»ä¸‹ä¸€æ­¥
  await tester.tap(find.text('ä¸‹ä¸€æ­¥'));
  await tester.pumpAndSettle();
  
  // è¾“å…¥éªŒè¯ç 
  // ...
});
```

### 9.3 å‹åŠ›æµ‹è¯•

1. **å‘é€éªŒè¯ç å‹åŠ›**
   - æ¨¡æ‹Ÿ1000ä¸ªå¹¶å‘è¯·æ±‚
   - éªŒè¯é¢‘ç‡é™åˆ¶æ˜¯å¦ç”Ÿæ•ˆ

2. **ç™»å½•æ¥å£å‹åŠ›**
   - æ¨¡æ‹Ÿ500ä¸ªå¹¶å‘ç™»å½•
   - æµ‹è¯•Tokenç”Ÿæˆæ€§èƒ½

---

## åã€éƒ¨ç½²å’Œç›‘æ§

### 10.1 éƒ¨ç½²é…ç½®

1. **ç¯å¢ƒå˜é‡**
```env
# çŸ­ä¿¡æœåŠ¡
SMS_PROVIDER=aliyun
SMS_ACCESS_KEY=xxx
SMS_ACCESS_SECRET=xxx
SMS_SIGN_NAME=ç½‘çƒç¤¾äº¤å¹³å°
SMS_TEMPLATE_CODE=SMS_xxx

# JWTé…ç½®
JWT_SECRET_KEY=your-secret-key
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# æ•°æ®åº“
DATABASE_URL=postgresql://user:password@localhost:5432/tennis_db
```

2. **Dockeréƒ¨ç½²**
```yaml
version: '3.8'
services:
  api:
    build: ./backend
    environment:
      - DATABASE_URL=${DATABASE_URL}
      - SMS_ACCESS_KEY=${SMS_ACCESS_KEY}
    ports:
      - "8000:8000"
  
  db:
    image: postgres:15
    environment:
      - POSTGRES_DB=tennis_db
      - POSTGRES_USER=user
      - POSTGRES_PASSWORD=password
    volumes:
      - postgres_data:/var/lib/postgresql/data
```

### 10.2 ç›‘æ§æŒ‡æ ‡

1. **ä¸šåŠ¡æŒ‡æ ‡**
   - æ¯æ—¥ç™»å½•ç”¨æˆ·æ•°
   - éªŒè¯ç å‘é€æˆåŠŸç‡
   - ç™»å½•æˆåŠŸç‡
   - ä¸€é”®ç™»å½•ä½¿ç”¨ç‡

2. **æŠ€æœ¯æŒ‡æ ‡**
   - APIå“åº”æ—¶é—´
   - é”™è¯¯ç‡
   - Tokenåˆ·æ–°é¢‘ç‡
   - æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½

3. **å®‰å…¨æŒ‡æ ‡**
   - å¼‚å¸¸ç™»å½•æ¬¡æ•°
   - éªŒè¯ç é”™è¯¯ç‡
   - IPé»‘åå•å‘½ä¸­æ•°

---

## åä¸€ã€åç»­ä¼˜åŒ–æ–¹å‘

### 11.1 çŸ­æœŸä¼˜åŒ–ï¼ˆ1-2ä¸ªæœˆï¼‰

1. **å¢å¼ºå®‰å…¨æ€§**
   - æ·»åŠ å›¾å½¢éªŒè¯ç ï¼ˆé˜²æœºå™¨äººï¼‰
   - è®¾å¤‡æŒ‡çº¹è¯†åˆ«
   - é£é™©æ§åˆ¶ç³»ç»Ÿ

2. **ä¼˜åŒ–ç”¨æˆ·ä½“éªŒ**
   - è®°ä½å›½å®¶ä»£ç é€‰æ‹©
   - è‡ªåŠ¨è¯†åˆ«æ‰‹æœºå·å½’å±åœ°
   - ä¼˜åŒ–éªŒè¯ç è¾“å…¥ä½“éªŒ

### 11.2 ä¸­æœŸåŠŸèƒ½ï¼ˆ3-6ä¸ªæœˆï¼‰

1. **ç¬¬ä¸‰æ–¹ç™»å½•**
   - å¾®ä¿¡ç™»å½•
   - QQç™»å½•
   - Apple IDç™»å½•

2. **è´¦å·ç»‘å®š**
   - æ”¯æŒç»‘å®šå¤šä¸ªç¬¬ä¸‰æ–¹è´¦å·
   - è´¦å·è§£ç»‘åŠŸèƒ½

### 11.3 é•¿æœŸè§„åˆ’ï¼ˆ6-12ä¸ªæœˆï¼‰

1. **ä¼ä¸šçº§åŠŸèƒ½**
   - SSOå•ç‚¹ç™»å½•
   - å¤šç§Ÿæˆ·æ”¯æŒ
   - æƒé™ç®¡ç†ç³»ç»Ÿ

2. **é«˜çº§å®‰å…¨**
   - åŒå› ç´ è®¤è¯ï¼ˆ2FAï¼‰
   - ç”Ÿç‰©è¯†åˆ«ï¼ˆæŒ‡çº¹ã€Face IDï¼‰
   - è¡Œä¸ºåˆ†æ

---

## åäºŒã€æ€»ç»“

æœ¬ç³»ç»Ÿé‡‡ç”¨ç°ä»£åŒ–çš„æ‰‹æœºå·éªŒè¯ç ç™»å½•æ–¹å¼ï¼Œç»“åˆä¸€é”®ç™»å½•åŠŸèƒ½ï¼Œä¸ºç”¨æˆ·æä¾›å®‰å…¨ã€ä¾¿æ·çš„èº«ä»½è®¤è¯ä½“éªŒã€‚ç›¸æ¯”ä¼ ç»Ÿçš„é‚®ç®±å¯†ç ç™»å½•ï¼š

**ä¼˜åŠ¿ï¼š**
1. **æ— éœ€è®°å¿†å¯†ç **ï¼šé™ä½ç”¨æˆ·å¿ƒç†è´Ÿæ‹…
2. **æ›´é«˜çš„å®‰å…¨æ€§**ï¼šæ¯æ¬¡ç™»å½•éƒ½éœ€è¦éªŒè¯æ‰‹æœºå·æ§åˆ¶æƒ
3. **æ›´å¿«çš„ç™»å½•é€Ÿåº¦**ï¼šä¸€é”®ç™»å½•å®ç°ç§’çº§ç™»å½•
4. **æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ**ï¼šç¬¦åˆç°ä»£ç§»åŠ¨åº”ç”¨ä¹ æƒ¯

**é€‚ç”¨åœºæ™¯ï¼š**
- ç§»åŠ¨ç«¯ä¸ºä¸»çš„åº”ç”¨
- å¯¹å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„åœºæ™¯
- éœ€è¦å¿«é€Ÿç”¨æˆ·å¢é•¿çš„äº§å“

é€šè¿‡åˆç†çš„æ¶æ„è®¾è®¡ã€å®Œå–„çš„å®‰å…¨æœºåˆ¶å’Œä¼˜ç§€çš„ç”¨æˆ·ä½“éªŒï¼Œä¸ºç½‘çƒç¤¾äº¤å¹³å°æ„å»ºäº†ä¸€ä¸ªå¯é çš„ç”¨æˆ·èº«ä»½è®¤è¯ç³»ç»Ÿã€‚
